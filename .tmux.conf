# Shell
set -g default-shell /bin/zsh

# Key Bindings
bind K confirm kill-server
bind C-c confirm kill-window
bind C-x confirm kill-pane
bind a last-window
bind r source-file ~/.tmux.conf
bind C-Space previous-layout

# Window/Pane Management
bind | split-window -hc "#{pane_current_path}"
bind & split-window -vc "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Pane Navigation (vim-style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Pane Resizing
bind < resize-pane -L 1
bind > resize-pane -R 1
bind v resize-pane -D 1
bind ^ resize-pane -U 1

# General Options
set -g bell-action none
set -g set-titles on
set -g base-index 1
setw -g pane-base-index 1
setw -g mode-keys vi
setw -g monitor-activity on
set -g visual-activity on
set -s escape-time 0

# Mouse Support
set -g mouse on

# Copy Mode & Clipboard Integration
# Only handle clipboard when NOT over SSH - let terminal handle it over SSH
if-shell '[ -z "$SSH_CONNECTION" ]' {
    bind-key -T copy-mode-vi v send-keys -X begin-selection
    bind-key -T copy-mode-vi y send-keys -X copy-pipe-no-clear 'sh -c "if uname | grep -q Darwin; then pbcopy; else xclip -in -selection clipboard; fi"' \; send-keys -X clear-selection \; display-message "Copied to clipboard"
    bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-no-clear 'sh -c "if uname | grep -q Darwin; then pbcopy; else xclip -in -selection clipboard; fi"' \; send-keys -X clear-selection \; display-message "Copied to clipboard"
}

# Status Bar
set -g status-interval 60
set -g status-right "#(whoami)"

# Colors & Display (True Color / 24-bit support)
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"
set -ga terminal-overrides ",alacritty:Tc"
